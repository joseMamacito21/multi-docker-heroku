sudo: required
services:
- docker
before_install:
- docker build -t josemelendezbolanos21/multi-heroku-test -f ./frontend/Dockerfile.dev
  ./frontend
script:
- docker run josemelendezbolanos21/multi-heroku-test npm run test -- --coverage
after_success:
- docker build -t josemelendezbolanos21/multi-heroku-frontend ./frontend
- docker build -t josemelendezbolanos21/multi-heroku-api ./api
- docker build -t josemelendezbolanos21/multi-heroku-nginx ./nginx
- echo "$DOCKER_PASSWORD" | docker login -u "$DOCKER_ID" --password-stdin
- docker push josemelendezbolanos21/multi-heroku-frontend
- docker push josemelendezbolanos21/multi-heroku-api
- docker push josemelendezbolanos21/multi-heroku-nginx
deploy:
  provider: heroku
  api_key:
    secure: iHVHlj6oXJhfKCEgMIors0r1m91jABam9Jd3nUEclUkidYF87kvQorYCRcZED4X8dNGon7B4xoB+PbOd6KjqRCmoQS7B2L2GkcR4UBohBK6LanO2PYqTOlX8FxaCcBFk69bFiEKfFkwsN6Mz+9KvrpI4mB4NhaGvcU8SJ4fdIr/1FAh7IpMfXjZnqLdE/Ik2SWBHjfeejLnOxob9fQe1BpHwcxyE/4w62hLWukGEZ0b9nLpI3wJ2dqTLD4sEqMvQ19BD8ngoLNAXJglQ1xrT7SEhSXk3w/C7pK3Jg319nbJeRY7VAcgwqqlXJTD47WK8qmu23ndSBbQRTccbxFlDjQcXmmZSbgJRPtmLu0b0hBkvPVuupT+zgAAlaTpHN+6Y9NYyYHQR+gRar8hZPfJV5myFsGkQ1vE4JBLj7T/8onyXBW4V0q47p8des8WQHozNyVKSY+gsPZSTBWi0GRz8Dz5X2L3ASejTJXHpIctFqS+ZtoomTCEXaR7Z1gzRLcncxsmYLgOrZyVejpH1JiysrXa40hDZn2+fhYYjArf/mP45ulE3OVXPhfMMWZUhSlMJidQinigyPp1BP1aaGtPC74Cwkl6NVgnwDAqnGGtR7Qdyw7lgnySLr0JG44u/qUwkB2GkVAgkRfRfdfo6MUhO7u6i21k9XUlJgwAkTXi2JkQ=
  app: sleepy-lake-32596
